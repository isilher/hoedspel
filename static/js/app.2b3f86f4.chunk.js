(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{215:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ge}));var r=n(184),a=n(1),i=n.n(a),o=n(370),l=n(9),u=n.n(l),s=n(46),c=n.n(s),m=n(10),d=n.n(m),g=n(368),f=n(369),h=n(138);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=n(20),y=n.n(v),j=n(6),E=n(66),w=n(19),_=n.n(w),C=n(59),O=n.n(C),I=n(50),x=n(7),k=n(204),$={light:{text:"#000",background:"#fff",tint:"#2f95dc",tabIconDefault:"#ccc",tabIconSelected:"#2f95dc"},dark:{text:"#fff",background:"#000",tint:"#fff",tabIconDefault:"#ccc",tabIconSelected:"#fff"}};function S(e,t){var n=e.light;return n||$.light[t]}function P(e){var t=e.style,n=e.lightColor,r=e.darkColor,i=O()(e,["style","lightColor","darkColor"]),o=S({light:n,dark:r},"text");return a.createElement(I.a,_()({style:[{color:o},t]},i))}function q(e){var t=e.style,n=e.lightColor,r=e.darkColor,i=O()(e,["style","lightColor","darkColor"]),o=S({light:n,dark:r},"background");return a.createElement(x.a,_()({style:[{backgroundColor:o},t]},i))}function z(e){var t=e.color,n=void 0===t?"#BA7CC6":t,r=e.onPress,i=e.title,o=e.disabled;return a.createElement(k.a,{onPress:o?void 0:r},a.createElement(q,{style:{backgroundColor:n,width:"100%",padding:10,borderWidth:1,borderColor:"#333",alignItems:"center",justifyContent:"center"}},a.createElement(P,{style:{color:"white",fontWeight:"bold"}},i)))}var M=n(137),G=n.n(M),B=n(8);function W(){var e=y()(["\n  query getUser($token: uuid!) {\n    users(where: { auth_id: {_eq: $token} }) {\n      auth_id\n      name\n    }\n  }\n"]);return W=function(){return e},e}function N(){var e=y()(["\n  mutation newUser($name: String!, $randomness: String!) {\n    insert_users(objects: {name: $name, auth_id_a: $randomness }) {\n      returning {\n        auth_id\n        name\n      }\n    }\n  }\n"]);return N=function(){return e},e}var Q=Object(B.gql)(N()),A=Object(B.gql)(W()),D=a.createContext({token:"",name:"",auth0Id:"",isAuthorized:!1}),H=function(e){var t=e.children,n=a.useState(""),r=d()(n,2),i=r[0],o=r[1],l=a.useState(""),s=d()(l,2),c=s[0],m=(s[1],a.useState("")),g=d()(m,2),f=g[0],h=g[1],p=a.useState(!1),b=d()(p,2),v=b[0],y=b[1],j=Object(B.useMutation)(Q,{onCompleted:function(e){var t,n=null==e||null==(t=e.insert_users)?void 0:t.returning[0];h(n.auth_id),y(!0),x(n.auth_id)}}),w=d()(j,2),_=w[0],C=w[1].loading,O=Object(B.useLazyQuery)(A,{onCompleted:function(e){var t=null==e?void 0:e.users[0];h(t.auth_id),o(t.name),y(!0)}}),I=d()(O,1)[0],x=function(e){return u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e),t.prev=1,t.next=4,u.a.awrap(G.a.setItem("@token",e));case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.log("could not save token");case 9:case"end":return t.stop()}}),null,null,[[1,6]],Promise)};return a.useEffect((function(){c||function(){var e;u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.awrap(G.a.getItem("@token"));case 3:null!==(e=t.sent)&&I({variables:{token:e}}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("could not retrieve token");case 10:case"end":return t.stop()}}),null,null,[[0,7]],Promise)}()}),[]),a.createElement(q,{style:J.container},a.createElement(D.Provider,{value:{token:c,name:i,auth0Id:f,isAuthorized:v}},v?t:a.createElement(q,{style:J.buttonContainer},a.createElement(P,{style:{marginBottom:50,fontSize:100}},"\ud83c\udfa9"),a.createElement(E.a,{style:J.textInput,value:i,onChangeText:o,placeholder:"Je naam"}),a.createElement(z,{disabled:C||""===i,title:"Spelen maar!",onPress:function(){_({variables:{name:i,randomness:"\ud83d\udca9"+Date.now().toString()}})}}))))},J=j.a.create({container:{flex:1},buttonContainer:{justifyContent:"center",alignItems:"center",height:"100%"},textInput:{padding:10,borderWidth:1,borderColor:"blue",marginBottom:15}}),T=function(e){var t=e.children,n=Object(a.useContext)(D),r=(n.token,n.auth0Id,function(e,t){var n=new B.HttpLink({uri:"https://sweeping-jay-28.hasura.app/v1/graphql"});return new B.ApolloClient({link:n,cache:new B.InMemoryCache})}());return i.a.createElement(B.ApolloProvider,{client:r},t)},L=n(106),F=n(214),V=n(41),R=function(){return i.a.createElement(q,{style:U.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"})},U=j.a.create({separator:{marginVertical:30,height:1,width:"80%"}});function K(){var e=y()(["\n  mutation joinGame($game: Int!, $userId: uuid!) {\n    update_users(where: {auth_id: {_eq: $userId}}, _set: {game_id: $game}) {\n      returning {\n        game_id\n        id\n      }\n    }\n  }\n"]);return K=function(){return e},e}function Z(){var e=y()(["\n  mutation createGame($name: String!, $userId: uuid!) {\n    insert_games(objects: {name: $name, host_id: $userId}) {\n      returning {\n        name\n        id\n      }\n    }\n  }\n"]);return Z=function(){return e},e}function X(){var e=y()(["\n  query getOpenGames {\n    games(where: {started: {_eq: false}}) {\n      id\n      name\n      players {\n        name\n      }\n    }\n  }\n"]);return X=function(){return e},e}var Y=Object(B.gql)(X()),ee=Object(B.gql)(Z()),te=Object(B.gql)(K()),ne=function(e){var t=e.game,n=a.useContext(D).auth0Id,r=Object(B.useMutation)(te,{refetchQueries:["getOpenGames","getMyGame"]}),i=d()(r,1)[0];return a.createElement(q,{style:ae.gameListItem},a.createElement(q,null,a.createElement(P,{style:ae.title},t.name),a.createElement(P,null,t.players.map((function(e){return e.name})).join(", "))),a.createElement(q,null,a.createElement(z,{color:"#BA7CC6",title:"meedoen",onPress:function(){i({variables:{game:t.id,userId:n}})}})))};function re(){var e,t=a.useState(""),n=d()(t,2),r=n[0],i=n[1],o=a.useContext(D),l=o.name,u=o.auth0Id,s=Object(B.useQuery)(Y,{pollInterval:5e3}),c=s.loading,m=s.data,g=Object(B.useMutation)(te,{refetchQueries:["getOpenGames","getMyGame"]}),f=d()(g,1)[0],h=Object(B.useMutation)(ee,{refetchQueries:["getOpenGames"],onCompleted:function(e){var t,n;f({variables:{game:null==e||null==(t=e.insert_games)||null==(n=t.returning[0])?void 0:n.id,userId:u}})}}),p=d()(h,1)[0],b=null!=(e=null==m?void 0:m.games)?e:[];return a.createElement(q,{style:ae.container},a.createElement(P,{style:ae.title},"Hoi ",l,"!"),a.createElement(R,null),a.createElement(P,{style:ae.title},"Kies een spel om aan mee te doen:"),c&&a.createElement(L.a,null),a.createElement(F.a,{style:ae.flatList,data:b,renderItem:function(e){var t=e.item;return a.createElement(ne,{game:t})},keyExtractor:function(e){return e.id.toString()}}),a.createElement(R,null),a.createElement(P,{style:ae.title},"Of maak een nieuw spel aan:"),a.createElement(q,{style:ae.row},a.createElement(E.a,{style:ae.textInput,placeholder:"Naam voor een nieuw spel",value:r,onChangeText:i}),a.createElement(z,{title:" + ",onPress:function(){p({variables:{name:r,userId:u}})}})))}var ae=j.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",paddingVertical:50,paddingHorizontal:15,height:V.a.get("window").height},title:{fontSize:20,fontWeight:"bold",marginBottom:15},row:{flexDirection:"row",width:"100%"},gameListItem:{padding:15,borderWidth:1,borderColor:"purple",flex:1,marginVertical:5,flexDirection:"row",justifyContent:"space-between"},textInput:{padding:10,marginRight:10,borderWidth:1,borderColor:"blue",flex:1},flatList:{backgroundColor:"#FFE3EC",width:"100%",borderWidth:1,borderColor:"#FFE3EC"},playButton:{backgroundColor:"#BA7CC6",justifyContent:"center",alignItems:"center"}});function ie(){var e=y()(["\n  query getMyGame($userId: uuid!) {\n    users(where: { auth_id: { _eq: $userId } }) {\n      id\n      game {\n        host_id\n        id\n        name\n        players {\n          name\n          id\n          claimed_names {\n            id\n            game_id\n          }\n        }\n        names(where: { claimed: { _eq: false } }) {\n          name\n          id\n        }\n        started\n        names_frozen\n        active_player {\n          auth_id\n          name\n          id\n        }\n      }\n    }\n  }\n"]);return ie=function(){return e},e}var oe=i.a.createContext({game:void 0,hosting:!1,myTurn:!1}),le=Object(B.gql)(ie()),ue=function(e){var t,n=e.children,r=i.a.useContext(D).auth0Id,a=Object(B.useQuery)(le,{variables:{userId:r}}).data,o=(null==a?void 0:a.users)?a.users[0].game:void 0,l=o&&o.host_id===r,u=o&&(null==o||null==(t=o.active_player)?void 0:t.auth_id)===r;return i.a.createElement(oe.Provider,{value:{game:o,hosting:l,myTurn:u}},n)},se=n(207),ce="web"===n(28).a.OS?{alert:function(e,t,n,r){if(window.confirm([e,t].filter(Boolean).join("\n"))){var a=n.find((function(e){return"cancel"!==e.style}));(null==a?void 0:a.onPress)&&a.onPress()}else{var i=n.find((function(e){return"cancel"===e.style}));(null==i?void 0:i.onPress)&&i.onPress()}}}:se.a;function me(){var e=y()(["\n  mutation resetRound($game: Int!) {\n    update_names(where: {game_id: {_eq: $game}}, _set: {claimed: false}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return me=function(){return e},e}function de(){var e=y()(["\n  mutation takeTurn($game: Int!, $userId: uuid!) {\n    update_games(where: {id: {_eq: $game}}, _set: {active_player_id: $userId}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return de=function(){return e},e}function ge(){var e=y()(["\n  mutation freezeNames($game: Int!) {\n    update_games(where: {id: {_eq: $game}}, _set: {names_frozen: true}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return ge=function(){return e},e}function fe(){var e=y()(["\n  mutation createName($game: Int!, $name: String!) {\n    insert_names(objects: {game_id: $game, name: $name}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return fe=function(){return e},e}function he(){var e=y()(["\n  mutation startGame($game: Int!) {\n    update_games(where: {id: {_eq: $game}}, _set: {started: true}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return he=function(){return e},e}function pe(){var e=y()(["\n  mutation destroyGame($game: Int!) {\n    delete_games(where: {id: {_eq: $game}}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return pe=function(){return e},e}function be(){var e=y()(["\n  mutation leaveGame($userId: uuid!) {\n    update_users(where: {auth_id: {_eq: $userId}}, _set: {game_id: null}) {\n      returning {\n        id\n        game_id\n      }\n    }\n  }\n"]);return be=function(){return e},e}var ve=Object(B.gql)(be()),ye=Object(B.gql)(pe()),je=Object(B.gql)(he()),Ee=Object(B.gql)(fe()),we=Object(B.gql)(ge()),_e=Object(B.gql)(de()),Ce=Object(B.gql)(me()),Oe=function(){var e=Object(a.useContext)(D).auth0Id,t=Object(a.useContext)(oe),n=t.game,r=t.hosting,o=Object(B.useMutation)(ve,{refetchQueries:["getOpenGames","getMyGame"]}),l=d()(o,1)[0],u=Object(B.useMutation)(ye,{refetchQueries:["getOpenGames","getMyGame"]}),s=d()(u,1)[0],c=Object(B.useMutation)(je,{refetchQueries:["getMyGame"]}),m=d()(c,1)[0],g=Object(B.useMutation)(we,{refetchQueries:["getMyGame"]}),f=d()(g,1)[0],h=Object(B.useMutation)(Ee,{refetchQueries:["getMyGame"]}),p=d()(h,1)[0],b=Object(B.useMutation)(_e,{refetchQueries:["getMyGame"]}),v=d()(b,1)[0],y=Object(B.useMutation)(Ce,{refetchQueries:["getMyGame"]}),j=d()(y,1)[0],w=Object(a.useState)(""),_=d()(w,2),C=_[0],O=_[1],I=Object(a.useState)(0),x=d()(I,2),k=x[0],$=x[1];return i.a.createElement(q,{style:Ie.container},i.a.createElement(q,null,i.a.createElement(P,{style:Ie.title},"Spel: ",n.name),!n.started&&i.a.createElement(P,null,"\ud83d\udd70 Het spel is nog niet gestart."),n.started&&i.a.createElement(P,null,"\ud83d\ude80 Het spel is gestart!"),i.a.createElement(R,null),i.a.createElement(P,{style:Ie.title},"Spelers:"),n.players.map((function(e){var t=(e.claimed_names||[]).filter((function(e){return e.game_id===n.id})).length;return i.a.createElement(P,{key:e.id.toString()},e.name," (",t," punten)")}))),n.started&&i.a.createElement(q,null,i.a.createElement(P,{style:Ie.nameCountingTitle},"Namen in de \ud83c\udfa9: ",n.names.length,"."),!n.names_frozen&&i.a.createElement(q,null,i.a.createElement(q,{style:Ie.row},i.a.createElement(E.a,{style:Ie.textInput,placeholder:"Naam voor in de hoed",value:C,onChangeText:O}),i.a.createElement(z,{title:" + ",onPress:function(){p({variables:{game:n.id,name:C}}),O(""),$((function(e){return e+1}))}})),i.a.createElement(P,null,"Jij hebt er ",k," toegevoegd.")),n.names_frozen&&!n.active_player&&!!n.names.length&&i.a.createElement(z,{color:"#BA7CC6",title:"Het is mijn beurt, ik ga presenteren.",onPress:function(){v({variables:{game:n.id,userId:e}})}}),n.names_frozen&&!!n.active_player&&i.a.createElement(P,{style:Ie.title},"\ud83d\udd7a ",n.active_player.name," is aan het presenteren."),n.names_frozen&&!n.names.length&&i.a.createElement(P,null,"De maker van het spel kan een nieuwe ronde starten. Vergeet niet de puntentelling op te schrijven!")),i.a.createElement(q,null,r&&!n.started&&i.a.createElement(z,{color:"#BA7CC6",title:"Starten",onPress:function(){ce.alert("Spel starten","Weet je zeker dat je het spel wilt starten? Er kunnen daarna geen spelers meer bij.",[{text:"Nee, nog niet",style:"cancel"},{text:"Ja, starten maar!",onPress:function(){m({variables:{game:n.id}})}}])}}),r&&n.started&&!n.names_frozen&&i.a.createElement(z,{color:"#BA7CC6",title:"Hoed sluiten",onPress:function(){ce.alert("Hoed sluiten","Weet je zeker dat je de hoed wilt sluiten? Er kunnen daarna geen namen meer bij.",[{text:"Nee, nog niet",style:"cancel"},{text:"Ja, sluiten maar!",onPress:function(){f({variables:{game:n.id}})}}])}}),r&&n.names_frozen&&!n.names.length&&i.a.createElement(z,{color:"#BA7CC6",title:"Nieuwe ronde starten",onPress:function(){ce.alert("Nieuwe ronde starten","In de nieuwe ronde gaan alle namen weer terug de hoed in. Zorg dat de scores opgeschreven staan.",[{text:"Nee, nog niet",style:"cancel"},{text:"Ja, herstarten maar!",onPress:function(){j({variables:{game:n.id}})}}])}}),i.a.createElement(R,null),r&&i.a.createElement(z,{color:"#d22461",title:"Spel verwijderen",onPress:function(){ce.alert("Spel verwijderen","Weet je zeker dat je het spel wilt verwijderen?",[{text:"Nee, toch niet",style:"cancel"},{text:"Ja, weg ermee",onPress:function(){s({variables:{game:n.id}})}}])}}),!r&&!n.started&&i.a.createElement(z,{color:"#d22461",title:"Spel verlaten",onPress:function(){ce.alert("Spel verlaten","Weet je zeker dat je het spel wilt verlaten?",[{text:"Nee, ik blijf",style:"cancel"},{text:"Ja, ik ga",onPress:function(){l({variables:{userId:e}})}}])}})))},Ie=j.a.create({container:{flex:1,justifyContent:"space-between",paddingHorizontal:15,paddingVertical:50},title:{fontSize:20,fontWeight:"bold",marginBottom:15},row:{flexDirection:"row",width:"100%",marginBottom:10},separator:{marginVertical:30,height:1,width:"80%"},gameListItem:{padding:15,borderWidth:1,borderColor:"purple",flex:1,marginVertical:5,flexDirection:"row",justifyContent:"space-between"},textInput:{padding:10,marginRight:10,borderWidth:1,borderColor:"blue",flex:1},flatList:{flex:1,backgroundColor:"#FFE3EC",width:"100%"},playButton:{backgroundColor:"#BA7CC6",justifyContent:"center",alignItems:"center"},nameCountingTitle:{fontSize:36,fontWeight:"bold",marginBottom:15}}),xe=n(208);function ke(){var e=y()(["\n  mutation claimName($name: Int!, $userId: uuid!) {\n    update_names(where: {id: {_eq: $name}}, _set: {claimed: true, claimer_id: $userId}) {\n      returning {\n        id\n      }\n    }\n}\n"]);return ke=function(){return e},e}function $e(){var e=y()(["\n  mutation takeTurn($game: Int!, $userId: uuid!) {\n    update_games(\n      where: { id: { _eq: $game } }\n      _set: { active_player_id: null }\n    ) {\n      returning {\n        id\n        names {\n          name\n        }\n      }\n    }\n  }\n"]);return $e=function(){return e},e}var Se=Object(B.gql)($e()),Pe=Object(B.gql)(ke()),qe=function(){var e=Object(a.useContext)(oe).game,t=Object(a.useContext)(D).auth0Id,n=Object(a.useState)(),r=d()(n,2),o=r[0],l=r[1],u=Object(B.useMutation)(Se,{variables:{game:e.id,userId:t},refetchQueries:["getMyGame"]}),s=d()(u,1)[0],c=Object(B.useMutation)(Pe,{variables:{name:null==o?void 0:o.id,userId:t},refetchQueries:["getMyGame"]}),m=d()(c,2),g=m[0],f=m[1].loading;Object(a.useEffect)((function(){l(Object(xe.sample)(e.names))}),[e.names]);return i.a.createElement(q,{style:ze.container},!!o&&i.a.createElement(z,{disabled:f,color:"#BA7CC6",title:"\ud83c\udf89 Geraden!",onPress:function(){g()}}),i.a.createElement(q,{style:ze.container},f&&i.a.createElement(L.a,null),!!o&&!f&&i.a.createElement(P,{style:ze.randomName},null==o?void 0:o.name),!o&&!f&&i.a.createElement(i.a.Fragment,null,i.a.createElement(P,{style:ze.randomName},"\ud83d\udc4d"),i.a.createElement(P,{style:ze.title},"De namen zijn op! Goed gedaan."))),i.a.createElement(z,{color:"#d22461",title:"Beurt be\xebindigen",onPress:function(){if(!o)return s();ce.alert("Spel verwijderen","Weet je zeker dat je je beurt wilt afsluiten?",[{text:"Nee, nog niet",style:"cancel"},{text:"Ja, klaar!",onPress:function(){s()}}])},disabled:f}))},ze=j.a.create({container:{flex:1,justifyContent:"center",alignItems:"center",paddingVertical:50,paddingHorizontal:15},randomName:{fontSize:72,fontWeight:"bold"},title:{fontSize:20,fontWeight:"bold",marginBottom:15}}),Me=function(){var e=Object(a.useContext)(oe),t=e.game;return e.myTurn?i.a.createElement(qe,null):t?i.a.createElement(Oe,null):i.a.createElement(re,null)};function Ge(){return function(){var e=a.useState(!1),t=d()(e,2),r=t[0],i=t[1];return a.useEffect((function(){u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h.b(),e.next=4,u.a.awrap(f.b(b(b({},g.a.font),{},{"space-mono":n(342)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,i(!0),h.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}()?i.a.createElement(o.a,null,i.a.createElement(T,null,i.a.createElement(H,null,i.a.createElement(ue,null,i.a.createElement(Me,null)))),i.a.createElement(r.StatusBar,null)):null}},219:function(e,t,n){n(220),e.exports=n(359)},220:function(e,t){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/hoedspel/expo-service-worker.js",{scope:"/hoedspel/"}).then((function(e){})).catch((function(e){console.info("Failed to register service-worker",e)}))}))},342:function(e,t,n){e.exports=n.p+"./fonts/SpaceMono-Regular.ttf"}},[[219,1,2]]]);
//# sourceMappingURL=app.2b3f86f4.chunk.js.map