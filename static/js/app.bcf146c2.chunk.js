(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{238:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ae}));var r=n(205),a=n(1),i=n.n(a),o=n(417),l=n(4),u=n.n(l),s=n(23),c=n.n(s),m=n(11),d=n.n(m),g=n(415),f=n(416),h=n(152);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=n(151),y=n(149),E=n.n(y),j=n(110),w=n(14),C=n(8),_=n(66),O=n(24),I=n.n(O),x=n(41),k=n.n(x),S=n(56),P=n(9),$=n(229),z={light:{text:"#000",background:"#fff",tint:"#2f95dc",tabIconDefault:"#ccc",tabIconSelected:"#2f95dc"},dark:{text:"#fff",background:"#000",tint:"#fff",tabIconDefault:"#ccc",tabIconSelected:"#fff"}};function q(e,t){var n=e.light;return n||z.light[t]}function G(e){var t=e.style,n=e.lightColor,r=e.darkColor,i=k()(e,["style","lightColor","darkColor"]),o=q({light:n,dark:r},"text");return a.createElement(S.a,I()({style:[{color:o},t]},i))}function M(e){var t=e.style,n=e.lightColor,r=e.darkColor,i=k()(e,["style","lightColor","darkColor"]),o=q({light:n,dark:r},"background");return a.createElement(P.a,I()({style:[{backgroundColor:o},t]},i))}function B(e){var t=e.color,n=void 0===t?"#BA7CC6":t,r=e.onPress,i=e.title,o=e.disabled;return a.createElement($.a,{onPress:o?void 0:r},a.createElement(M,{style:{backgroundColor:n,width:"100%",padding:10,borderWidth:1,borderColor:"#333",alignItems:"center",justifyContent:"center"}},a.createElement(G,{style:{color:"white",fontWeight:"bold"}},i)))}var W=n(150),N=n.n(W),A=w.a.select({web:!1,default:!0}),D=v.a({useProxy:A});"https://isilher.github.io"===D&&(D="https://isilher.github.io/hoedspel"),_.b();var Q=(Date.now()*Math.random()).toString(),J=a.createContext({token:"",name:"",auth0Id:"",isAuthorized:!1}),H=function(e){var t=e.children,n=a.useState(""),r=d()(n,2),i=r[0],o=r[1],l=a.useState(""),s=d()(l,2),c=s[0],m=s[1],g=a.useState(""),f=d()(g,2),h=f[0],p=f[1],b=a.useState(!1),y=d()(b,2),w=y[0],C=y[1],_=v.b({redirectUri:D,clientId:"Gj9Y0KJGtJNCm1SZrUqRODvIc84dwrAY",responseType:"id_token",scopes:["openid","profile"],extraParams:{nonce:Q}},{authorizationEndpoint:"https://dev-5hh3kz1x.eu.auth0.com/authorize"}),O=d()(_,3),I=O[0],x=O[1],k=O[2];return a.useEffect((function(){if(x){if(x.error)return void j.a.alert("Authentication error",x.params.error_description||"something went wrong");if("success"===x.type){var e=x.params.id_token;a=e,u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a),e.prev=1,e.next=4,u.a.awrap(N.a.setItem("@token",a));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("could not save token");case 9:case"end":return e.stop()}}),null,null,[[1,6]],Promise);var t=E()(e),n=t.nickname,r=t.sub;o(n),m(e),p(r),C(!0)}}var a}),[x]),a.useEffect((function(){!function(){var e,t,n,r;u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u.a.awrap(N.a.getItem("@token"));case 3:null!==(e=a.sent)&&(t=E()(e),n=t.nickname,r=t.sub,o(n),m(c),p(r),C(!0)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log("could not retrieve token");case 10:case"end":return a.stop()}}),null,null,[[0,7]],Promise)}()}),[]),a.createElement(M,{style:T.container},a.createElement(J.Provider,{value:{token:c,name:i,auth0Id:h,isAuthorized:w}},w?t:a.createElement(M,{style:T.buttonContainer},a.createElement(G,{style:{marginBottom:50,fontSize:100}},"\ud83c\udfa9"),a.createElement(B,{disabled:!I,title:"Log in",onPress:function(){return k({useProxy:A})}}))))},T=C.a.create({container:{flex:1},buttonContainer:{justifyContent:"center",alignItems:"center",height:"100%"}}),L=n(13),F=function(e){var t=e.children,n=Object(a.useContext)(J),r=n.token,o=(n.auth0Id,function(e,t){var n=new L.HttpLink({uri:"https://sweeping-jay-28.hasura.app/v1/graphql",headers:{Authorization:"Bearer "+e}});return new L.ApolloClient({link:n,cache:new L.InMemoryCache})}(r));return i.a.createElement(L.ApolloProvider,{client:o},t)},V=n(28),R=n.n(V),K=n(113),U=n(114),Y=n(237),Z=n(42),X=function(){return i.a.createElement(M,{style:ee.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"})},ee=C.a.create({separator:{marginVertical:30,height:1,width:"80%"}});function te(){var e=R()(["\n  mutation joinGame($game: Int!, $userId: String!) {\n    update_users(where: {auth0_id: {_eq: $userId}}, _set: {game_id: $game}) {\n      returning {\n        game_id\n        id\n      }\n    }\n  }\n"]);return te=function(){return e},e}function ne(){var e=R()(["\n  mutation createGame($name: String!, $userId: String!) {\n    insert_games(objects: {name: $name, host_id: $userId}) {\n      returning {\n        name\n        id\n      }\n    }\n  }\n"]);return ne=function(){return e},e}function re(){var e=R()(["\n  query getOpenGames {\n    games(where: {started: {_eq: false}}) {\n      id\n      name\n      players {\n        name\n      }\n    }\n  }\n"]);return re=function(){return e},e}var ae=Object(L.gql)(re()),ie=Object(L.gql)(ne()),oe=Object(L.gql)(te()),le=function(e){var t=e.game,n=a.useContext(J).auth0Id,r=Object(L.useMutation)(oe,{refetchQueries:["getOpenGames","getMyGame"]}),i=d()(r,1)[0];return a.createElement(M,{style:se.gameListItem},a.createElement(M,null,a.createElement(G,{style:se.title},t.name),a.createElement(G,null,t.players.map((function(e){return e.name})).join(", "))),a.createElement(M,null,a.createElement(B,{color:"#BA7CC6",title:"meedoen",onPress:function(){i({variables:{game:t.id,userId:n}})}})))};function ue(){var e,t=a.useState(""),n=d()(t,2),r=n[0],i=n[1],o=a.useContext(J),l=o.name,u=o.auth0Id,s=Object(L.useQuery)(ae,{pollInterval:5e3}),c=s.loading,m=s.data,g=Object(L.useMutation)(oe,{refetchQueries:["getOpenGames","getMyGame"]}),f=d()(g,1)[0],h=Object(L.useMutation)(ie,{refetchQueries:["getOpenGames"],onCompleted:function(e){var t,n;f({variables:{game:null==e||null==(t=e.insert_games)||null==(n=t.returning[0])?void 0:n.id,userId:u}})}}),p=d()(h,1)[0],b=null!=(e=null==m?void 0:m.games)?e:[];return a.createElement(M,{style:se.container},a.createElement(G,{style:se.title},"Hoi ",l,"!"),a.createElement(X,null),a.createElement(G,{style:se.title},"Kies een spel om aan mee te doen:"),c&&a.createElement(K.a,null),a.createElement(Y.a,{style:se.flatList,data:b,renderItem:function(e){var t=e.item;return a.createElement(le,{game:t})},keyExtractor:function(e){return e.id.toString()}}),a.createElement(X,null),a.createElement(G,{style:se.title},"Of maak een nieuw spel aan:"),a.createElement(M,{style:se.row},a.createElement(U.a,{style:se.textInput,placeholder:"Naam voor een nieuw spel",value:r,onChangeText:i}),a.createElement(B,{title:" + ",onPress:function(){p({variables:{name:r,userId:u}})}})))}var se=C.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",paddingVertical:50,paddingHorizontal:15,height:Z.a.get("window").height},title:{fontSize:20,fontWeight:"bold",marginBottom:15},row:{flexDirection:"row",width:"100%"},gameListItem:{padding:15,borderWidth:1,borderColor:"purple",flex:1,marginVertical:5,flexDirection:"row",justifyContent:"space-between"},textInput:{padding:10,marginRight:10,borderWidth:1,borderColor:"blue",flex:1},flatList:{backgroundColor:"#FFE3EC",width:"100%",borderWidth:1,borderColor:"#FFE3EC"},playButton:{backgroundColor:"#BA7CC6",justifyContent:"center",alignItems:"center"}});function ce(){var e=R()(["\n  query getMyGame($userId: String!) {\n    users(where: { auth0_id: { _eq: $userId } }) {\n      id\n      game {\n        host_id\n        id\n        name\n        players {\n          name\n          id\n          claimed_names {\n            id\n            game_id\n          }\n        }\n        names(where: { claimed: { _eq: false } }) {\n          name\n          id\n        }\n        started\n        names_frozen\n        active_player {\n          auth0_id\n          name\n          id\n        }\n      }\n    }\n  }\n"]);return ce=function(){return e},e}var me=i.a.createContext({game:void 0,hosting:!1,myTurn:!1}),de=Object(L.gql)(ce()),ge=function(e){var t,n=e.children,r=i.a.useContext(J).auth0Id,a=Object(L.useQuery)(de,{variables:{userId:r}}).data,o=(null==a?void 0:a.users)?a.users[0].game:void 0,l=o&&o.host_id===r,u=o&&(null==o||null==(t=o.active_player)?void 0:t.auth0_id)===r;return i.a.createElement(me.Provider,{value:{game:o,hosting:l,myTurn:u}},n)},fe="web"===w.a.OS?{alert:function(e,t,n,r){if(window.confirm([e,t].filter(Boolean).join("\n"))){var a=n.find((function(e){return"cancel"!==e.style}));(null==a?void 0:a.onPress)&&a.onPress()}else{var i=n.find((function(e){return"cancel"===e.style}));(null==i?void 0:i.onPress)&&i.onPress()}}}:j.a;function he(){var e=R()(["\n  mutation resetRound($game: Int!) {\n    update_names(where: {game_id: {_eq: $game}}, _set: {claimed: false}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return he=function(){return e},e}function pe(){var e=R()(["\n  mutation takeTurn($game: Int!, $userId: String!) {\n    update_games(where: {id: {_eq: $game}}, _set: {active_player_id: $userId}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return pe=function(){return e},e}function be(){var e=R()(["\n  mutation freezeNames($game: Int!) {\n    update_games(where: {id: {_eq: $game}}, _set: {names_frozen: true}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return be=function(){return e},e}function ve(){var e=R()(["\n  mutation createName($game: Int!, $name: String!) {\n    insert_names(objects: {game_id: $game, name: $name}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return ve=function(){return e},e}function ye(){var e=R()(["\n  mutation startGame($game: Int!) {\n    update_games(where: {id: {_eq: $game}}, _set: {started: true}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return ye=function(){return e},e}function Ee(){var e=R()(["\n  mutation destroyGame($game: Int!) {\n    delete_games(where: {id: {_eq: $game}}) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return Ee=function(){return e},e}function je(){var e=R()(["\n  mutation leaveGame($userId: String!) {\n    update_users(where: {auth0_id: {_eq: $userId}}, _set: {game_id: null}) {\n      returning {\n        id\n        game_id\n      }\n    }\n  }\n"]);return je=function(){return e},e}var we=Object(L.gql)(je()),Ce=Object(L.gql)(Ee()),_e=Object(L.gql)(ye()),Oe=Object(L.gql)(ve()),Ie=Object(L.gql)(be()),xe=Object(L.gql)(pe()),ke=Object(L.gql)(he()),Se=function(){var e=Object(a.useContext)(J).auth0Id,t=Object(a.useContext)(me),n=t.game,r=t.hosting,o=Object(L.useMutation)(we,{refetchQueries:["getOpenGames","getMyGame"]}),l=d()(o,1)[0],u=Object(L.useMutation)(Ce,{refetchQueries:["getOpenGames","getMyGame"]}),s=d()(u,1)[0],c=Object(L.useMutation)(_e,{refetchQueries:["getMyGame"]}),m=d()(c,1)[0],g=Object(L.useMutation)(Ie,{refetchQueries:["getMyGame"]}),f=d()(g,1)[0],h=Object(L.useMutation)(Oe,{refetchQueries:["getMyGame"]}),p=d()(h,1)[0],b=Object(L.useMutation)(xe,{refetchQueries:["getMyGame"]}),v=d()(b,1)[0],y=Object(L.useMutation)(ke,{refetchQueries:["getMyGame"]}),E=d()(y,1)[0],j=Object(a.useState)(""),w=d()(j,2),C=w[0],_=w[1],O=Object(a.useState)(0),I=d()(O,2),x=I[0],k=I[1];return i.a.createElement(M,{style:Pe.container},i.a.createElement(M,null,i.a.createElement(G,{style:Pe.title},"Spel: ",n.name),!n.started&&i.a.createElement(G,null,"\ud83d\udd70 Het spel is nog niet gestart."),n.started&&i.a.createElement(G,null,"\ud83d\ude80 Het spel is gestart!"),i.a.createElement(X,null),i.a.createElement(G,{style:Pe.title},"Spelers:"),n.players.map((function(e){var t=(e.claimed_names||[]).filter((function(e){return e.game_id===n.id})).length;return i.a.createElement(G,{key:e.id.toString()},e.name," (",t," punten)")}))),n.started&&i.a.createElement(M,null,i.a.createElement(G,{style:Pe.nameCountingTitle},"Namen in de \ud83c\udfa9: ",n.names.length,"."),!n.names_frozen&&i.a.createElement(M,null,i.a.createElement(M,{style:Pe.row},i.a.createElement(U.a,{style:Pe.textInput,placeholder:"Naam voor in de hoed",value:C,onChangeText:_}),i.a.createElement(B,{title:" + ",onPress:function(){p({variables:{game:n.id,name:C}}),_(""),k((function(e){return e+1}))}})),i.a.createElement(G,null,"Jij hebt er ",x," toegevoegd.")),n.names_frozen&&!n.active_player&&!!n.names.length&&i.a.createElement(B,{color:"#BA7CC6",title:"Het is mijn beurt, ik ga presenteren.",onPress:function(){v({variables:{game:n.id,userId:e}})}}),n.names_frozen&&!!n.active_player&&i.a.createElement(G,{style:Pe.title},"\ud83d\udd7a ",n.active_player.name," is aan het presenteren."),n.names_frozen&&!n.names.length&&i.a.createElement(G,null,"De maker van het spel kan een nieuwe ronde starten. Vergeet niet de puntentelling op te schrijven!")),i.a.createElement(M,null,r&&!n.started&&i.a.createElement(B,{color:"#BA7CC6",title:"Starten",onPress:function(){fe.alert("Spel starten","Weet je zeker dat je het spel wilt starten? Er kunnen daarna geen spelers meer bij.",[{text:"Nee, nog niet",style:"cancel"},{text:"Ja, starten maar!",onPress:function(){m({variables:{game:n.id}})}}])}}),r&&n.started&&!n.names_frozen&&i.a.createElement(B,{color:"#BA7CC6",title:"Hoed sluiten",onPress:function(){fe.alert("Hoed sluiten","Weet je zeker dat je de hoed wilt sluiten? Er kunnen daarna geen namen meer bij.",[{text:"Nee, nog niet",style:"cancel"},{text:"Ja, sluiten maar!",onPress:function(){f({variables:{game:n.id}})}}])}}),r&&n.names_frozen&&!n.names.length&&i.a.createElement(B,{color:"#BA7CC6",title:"Nieuwe ronde starten",onPress:function(){fe.alert("Nieuwe ronde starten","In de nieuwe ronde gaan alle namen weer terug de hoed in. Zorg dat de scores opgeschreven staan.",[{text:"Nee, nog niet",style:"cancel"},{text:"Ja, herstarten maar!",onPress:function(){E({variables:{game:n.id}})}}])}}),i.a.createElement(X,null),r&&i.a.createElement(B,{color:"#d22461",title:"Spel verwijderen",onPress:function(){fe.alert("Spel verwijderen","Weet je zeker dat je het spel wilt verwijderen?",[{text:"Nee, toch niet",style:"cancel"},{text:"Ja, weg ermee",onPress:function(){s({variables:{game:n.id}})}}])}}),!r&&!n.started&&i.a.createElement(B,{color:"#d22461",title:"Spel verlaten",onPress:function(){fe.alert("Spel verlaten","Weet je zeker dat je het spel wilt verlaten?",[{text:"Nee, ik blijf",style:"cancel"},{text:"Ja, ik ga",onPress:function(){l({variables:{userId:e}})}}])}})))},Pe=C.a.create({container:{flex:1,justifyContent:"space-between",paddingHorizontal:15,paddingVertical:50},title:{fontSize:20,fontWeight:"bold",marginBottom:15},row:{flexDirection:"row",width:"100%",marginBottom:10},separator:{marginVertical:30,height:1,width:"80%"},gameListItem:{padding:15,borderWidth:1,borderColor:"purple",flex:1,marginVertical:5,flexDirection:"row",justifyContent:"space-between"},textInput:{padding:10,marginRight:10,borderWidth:1,borderColor:"blue",flex:1},flatList:{flex:1,backgroundColor:"#FFE3EC",width:"100%"},playButton:{backgroundColor:"#BA7CC6",justifyContent:"center",alignItems:"center"},nameCountingTitle:{fontSize:36,fontWeight:"bold",marginBottom:15}}),$e=n(232);function ze(){var e=R()(["\n  mutation claimName($name: Int!, $userId: String!) {\n    update_names(where: {id: {_eq: $name}}, _set: {claimed: true, claimer_id: $userId}) {\n      returning {\n        id\n      }\n    }\n}\n"]);return ze=function(){return e},e}function qe(){var e=R()(["\n  mutation takeTurn($game: Int!, $userId: String!) {\n    update_games(\n      where: { id: { _eq: $game } }\n      _set: { active_player_id: null }\n    ) {\n      returning {\n        id\n        names {\n          name\n        }\n      }\n    }\n  }\n"]);return qe=function(){return e},e}var Ge=Object(L.gql)(qe()),Me=Object(L.gql)(ze()),Be=function(){var e=Object(a.useContext)(me).game,t=Object(a.useContext)(J).auth0Id,n=Object(a.useState)(),r=d()(n,2),o=r[0],l=r[1],u=Object(L.useMutation)(Ge,{variables:{game:e.id,userId:t},refetchQueries:["getMyGame"]}),s=d()(u,1)[0],c=Object(L.useMutation)(Me,{variables:{name:null==o?void 0:o.id,userId:t},refetchQueries:["getMyGame"]}),m=d()(c,2),g=m[0],f=m[1].loading;Object(a.useEffect)((function(){l(Object($e.sample)(e.names))}),[e.names]);return i.a.createElement(M,{style:We.container},!!o&&i.a.createElement(B,{disabled:f,color:"#BA7CC6",title:"\ud83c\udf89 Geraden!",onPress:function(){g()}}),i.a.createElement(M,{style:We.container},f&&i.a.createElement(K.a,null),!!o&&!f&&i.a.createElement(G,{style:We.randomName},null==o?void 0:o.name),!o&&!f&&i.a.createElement(i.a.Fragment,null,i.a.createElement(G,{style:We.randomName},"\ud83d\udc4d"),i.a.createElement(G,{style:We.title},"De namen zijn op! Goed gedaan."))),i.a.createElement(B,{color:"#d22461",title:"Beurt be\xebindigen",onPress:function(){if(!o)return s();fe.alert("Spel verwijderen","Weet je zeker dat je je beurt wilt afsluiten?",[{text:"Nee, nog niet",style:"cancel"},{text:"Ja, klaar!",onPress:function(){s()}}])},disabled:f}))},We=C.a.create({container:{flex:1,justifyContent:"center",alignItems:"center",paddingVertical:50,paddingHorizontal:15},randomName:{fontSize:72,fontWeight:"bold"},title:{fontSize:20,fontWeight:"bold",marginBottom:15}}),Ne=function(){var e=Object(a.useContext)(me),t=e.game;return e.myTurn?i.a.createElement(Be,null):t?i.a.createElement(Se,null):i.a.createElement(ue,null)};function Ae(){return function(){var e=a.useState(!1),t=d()(e,2),r=t[0],i=t[1];return a.useEffect((function(){u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h.b(),e.next=4,u.a.awrap(f.b(b(b({},g.a.font),{},{"space-mono":n(366)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,i(!0),h.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}()?i.a.createElement(o.a,null,i.a.createElement(H,null,i.a.createElement(F,null,i.a.createElement(ge,null,i.a.createElement(Ne,null)))),i.a.createElement(r.StatusBar,null)):null}},243:function(e,t,n){n(244),e.exports=n(406)},244:function(e,t){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/hoedspel/expo-service-worker.js",{scope:"/hoedspel/"}).then((function(e){})).catch((function(e){console.info("Failed to register service-worker",e)}))}))},366:function(e,t,n){e.exports=n.p+"./fonts/SpaceMono-Regular.ttf"}},[[243,1,2]]]);
//# sourceMappingURL=app.bcf146c2.chunk.js.map